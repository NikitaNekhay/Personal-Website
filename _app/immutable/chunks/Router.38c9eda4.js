import{S as B,i as G,s as q,L as z,M as X,N as F,O as J,g as K,d as Q,a3 as w,X as I,G as k,o as V}from"./index.476e330c.js";import{w as P,d as W}from"./index.e237a6ff.js";const L={},M={},Z={},x=t=>({...t.location,state:t.history.state,key:t.history.state&&t.history.state.key||"initial"}),$=t=>{const s=[];let o=x(t);return{get location(){return o},listen(e){s.push(e);const n=()=>{o=x(t),e({location:o,action:"POP"})};return t.addEventListener("popstate",n),()=>{t.removeEventListener("popstate",n);const i=s.indexOf(e);s.splice(i,1)}},navigate(e,{state:n,replace:i=!1}={}){n={...n,key:Date.now()+""};try{i?t.history.replaceState(n,null,e):t.history.pushState(n,null,e)}catch{t.location[i?"replace":"assign"](e)}o=x(t),s.forEach(r=>r({location:o,action:"PUSH"})),document.activeElement.blur()}}},tt=(t="/")=>{let s=0;const o=[{pathname:t,search:""}],e=[];return{get location(){return o[s]},addEventListener(n,i){},removeEventListener(n,i){},history:{get entries(){return o},get index(){return s},get state(){return e[s]},pushState(n,i,r){const[m,l=""]=r.split("?");s++,o.push({pathname:m,search:l}),e.push(n)},replaceState(n,i,r){const[m,l=""]=r.split("?");o[s]={pathname:m,search:l},e[s]=n}}}},et=typeof window<"u"&&"document"in window,nt=$(et?window:tt()),H=/^:(.+)/,N=4,st=3,ot=2,at=1,it=1,E=t=>t.replace(/(^\/+|\/+$)/g,"").split("/"),C=t=>t.replace(/(^\/+|\/+$)/g,""),ct=(t,s)=>{const o=t.default?0:E(t.path).reduce((e,n)=>(e+=N,n===""?e+=it:H.test(n)?e+=ot:n[0]==="*"?e-=N+at:e+=st,e),0);return{route:t,score:o,index:s}},rt=t=>t.map(ct).sort((s,o)=>s.score<o.score?1:s.score>o.score?-1:s.index-o.index),A=(t,s)=>{let o,e;const[n]=s.split("?"),i=E(n),r=i[0]==="",m=rt(t);for(let l=0,b=m.length;l<b;l++){const h=m[l].route;let p=!1;if(h.default){e={route:h,params:{},uri:s};continue}const O=E(h.path),R={},g=Math.max(i.length,O.length);let c=0;for(;c<g;c++){const f=O[c],_=i[c];if(f&&f[0]==="*"){const T=f==="*"?"*":f.slice(1);R[T]=i.slice(c).map(decodeURIComponent).join("/");break}if(typeof _>"u"){p=!0;break}const y=H.exec(f);if(y&&!r){const T=decodeURIComponent(_);R[y[1]]=T}else if(f!==_){p=!0;break}}if(!p){o={route:h,params:R,uri:"/"+i.slice(0,c).join("/")};break}}return o||e||null},v=(t,s)=>`${C(s==="/"?t:`${C(t)}/${C(s)}`)}/`,lt=t=>({route:t&2,location:t&1}),U=t=>({route:t[1]&&t[1].uri,location:t[0]});function ut(t){let s;const o=t[12].default,e=z(o,t,t[11],U);return{c(){e&&e.c()},l(n){e&&e.l(n)},m(n,i){e&&e.m(n,i),s=!0},p(n,[i]){e&&e.p&&(!s||i&2051)&&X(e,o,n,n[11],s?J(o,n[11],i,lt):F(n[11]),U)},i(n){s||(K(e,n),s=!0)},o(n){Q(e,n),s=!1},d(n){e&&e.d(n)}}}function ht(t,s,o){let e,n,i,r,{$$slots:m={},$$scope:l}=s,{basepath:b="/"}=s,{url:h=null}=s,{history:p=nt}=s;w(Z,p);const O=I(L),R=I(M),g=P([]);k(t,g,a=>o(9,n=a));const c=P(null);k(t,c,a=>o(1,r=a));let f=!1;const _=O||P(h?{pathname:h}:p.location);k(t,_,a=>o(0,e=a));const y=R?R.routerBase:P({path:b,uri:b});k(t,y,a=>o(10,i=a));const T=W([y,c],([a,u])=>{if(!u)return a;const{path:d}=a,{route:S,uri:j}=u;return{path:S.default?d:S.path.replace(/\*.*$/,""),uri:j}}),D=a=>{const{path:u}=i;let{path:d}=a;if(a._path=d,a.path=v(u,d),typeof window>"u"){if(f)return;const S=A([a],e.pathname);S&&(c.set(S),f=!0)}else g.update(S=>[...S,a])},Y=a=>{g.update(u=>u.filter(d=>d!==a))};return O||(V(()=>p.listen(u=>{_.set(u.location)})),w(L,_)),w(M,{activeRoute:c,base:y,routerBase:T,registerRoute:D,unregisterRoute:Y}),t.$$set=a=>{"basepath"in a&&o(6,b=a.basepath),"url"in a&&o(7,h=a.url),"history"in a&&o(8,p=a.history),"$$scope"in a&&o(11,l=a.$$scope)},t.$$.update=()=>{if(t.$$.dirty&1024){const{path:a}=i;g.update(u=>u.map(d=>({...d,path:v(a,d._path)})))}if(t.$$.dirty&513){const a=A(n,e.pathname);c.set(a)}},[e,r,g,c,_,y,b,h,p,n,i,l,m]}class mt extends B{constructor(s){super(),G(this,s,ht,ut,q,{basepath:6,url:7,history:8})}}export{mt as R,M as a};
